<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>note - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Docker">Docker</a>&nbsp;»&nbsp;note</div>
</div>
<div class="clearfix"></div>
<div id="title">note</div>
  <div id="content">
  <ul>
<li>docker 思想</li>
</ul>
<p>每容器只做一件事</p>
<ul>
<li>read</li>
</ul>
<p><a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/">Dockerfile 最佳实践</a></p>
<p><a href="http://dockone.io/article/783">10张图带你深入理解Docker容器和镜像</a></p>
<h2 id="cmd">cmd</h2>
<h3 id="run">run</h3>
<ul>
<li>-p</li>
</ul>
<div class="hlcode"><pre><span class="nb">run</span> <span class="na">-p</span> <span class="o">&lt;</span><span class="nx">host_port</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="nx">container_port</span><span class="o">&gt;</span>
<span class="nx">e.g.</span> <span class="nb">run</span> <span class="na">-p</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">8000</span>
</pre></div>


<h2 id="install-docker">install docker</h2>
<ul>
<li>
<p><a href="https://docs.docker.com/engine/installation/"> 官方安装教程 </a></p>
</li>
<li>
<p>cmd line</p>
</li>
</ul>
<div class="hlcode"><pre><span class="cp"># success for debian, ubuntu, kali</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="o">:</span><span class="c1">//get.docker.com/ | sh</span>
</pre></div>


<h2 id="daocloud"><a href="https://account.daocloud.io/signup"> Daocloud </a></h2>
<p><a href="http://blog.saymagic.cn/2015/06/01/learning-docker.html">docker 简明教程</a></p>
<h2 id="docker-hub"><a href="https://hub.docker.com/"> Docker Hub </a></h2>
<ul>
<li>login</li>
</ul>
<div class="hlcode"><pre><span class="n">docker</span> <span class="n">login</span>
<span class="cp"># then input username, email password</span>
</pre></div>


<ul>
<li>push</li>
</ul>
<div class="hlcode"><pre><span class="cp"># build</span>
<span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">username</span><span class="o">/</span><span class="n">newimage</span><span class="o">:</span><span class="n">tag</span> <span class="p">.</span>

<span class="cp"># http:</span><span class="c1">//hub.docker.com &gt; Create Repository </span>
<span class="n">docker</span> <span class="n">push</span> <span class="n">username</span><span class="o">/</span><span class="n">newimage</span>
</pre></div>


<div class="hlcode"><pre><span class="cp"># 查看环境信息</span>
<span class="n">docker</span> <span class="n">info</span>  
<span class="n">docker</span> <span class="n">version</span>

<span class="cp"># 在官方仓库中查找镜像</span>
<span class="n">docker</span> <span class="n">search</span> <span class="n">ubuntu</span>

<span class="cp"># 下载获取ubuntu镜像</span>
<span class="n">docker</span> <span class="n">pull</span> <span class="n">ubuntu</span>

<span class="cp"># 列出本机拥有的镜像</span>
<span class="n">docker</span> <span class="n">images</span>

<span class="cp"># 以交互方式从ubuntu镜像启动容器后运行bash, 并指定容器名称为test</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">name</span> <span class="n">test</span> <span class="n">ubuntu</span> <span class="n">bash</span>

<span class="cp"># 容器停止后自动删除, 测试的时候常用</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="n">ubuntu</span> <span class="n">bash</span>

<span class="cp"># 容器启动的时候挂载本机workspace目录到容器的根目录下</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">v</span> <span class="o">~/</span><span class="n">workspace</span><span class="o">:/</span><span class="n">workspace</span> <span class="n">ubuntu</span> <span class="n">bash</span>

<span class="cp"># 以后台进程的方式启动容器</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="n">ubuntu</span> <span class="n">echo</span> <span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span> <span class="o">&gt;</span> <span class="o">~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="cp"># 列出目前运行的容器</span>
<span class="n">docker</span> <span class="n">ps</span>

<span class="cp"># 列出最近的容器，包含未正在运行的</span>
<span class="n">docker</span> <span class="n">ps</span> <span class="o">-</span><span class="n">l</span>

<span class="cp"># 挂载一个正在后台运行的容器</span>
<span class="n">docker</span> <span class="n">attach</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 列出并追踪容器的运行日志</span>
<span class="n">docker</span> <span class="n">logs</span> <span class="o">-</span><span class="n">f</span> <span class="o">-</span><span class="n">t</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 暂停运行的容器</span>
<span class="n">docker</span> <span class="n">pause</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 恢复暂停的容器</span>
<span class="n">docker</span> <span class="n">unpause</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 启动/停止/重启容器(start/stop/restart)</span>
<span class="n">docker</span> <span class="n">start</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 显示容器内运行的进程, 每2s刷新一次</span>
<span class="n">docker</span> <span class="n">top</span> <span class="mi">23</span><span class="n">ad234</span> <span class="o">-</span><span class="n">d</span> <span class="mi">2</span>

<span class="cp"># 查看容器运行的详细信息</span>
<span class="n">docker</span> <span class="n">inspect</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 杀掉正在运行的容器</span>
<span class="n">docker</span> <span class="n">kill</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 显示容器文件系统的改动</span>
<span class="n">docker</span> <span class="n">diff</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 复制容器中的文件或文件夹到主机系统中</span>
<span class="n">docker</span> <span class="n">cp</span> <span class="mi">23</span><span class="n">ad234</span><span class="o">:~/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="p">.</span><span class="o">/</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span>

<span class="cp"># 将容器导出为tar包</span>
<span class="n">docker</span> <span class="n">export</span> <span class="mi">23</span><span class="n">ad234</span> <span class="o">&gt;</span> <span class="n">mytest</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">tar</span>

<span class="cp"># 创建一个空容器并导入tar包</span>
<span class="n">docker</span> <span class="n">import</span> <span class="p">.</span><span class="o">/</span><span class="n">mytest</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">tar</span>

<span class="cp"># 将容器改动提交到镜像中</span>
<span class="n">docker</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="n">mytest</span> <span class="mi">23</span><span class="n">ad234</span> <span class="n">ijse</span><span class="o">/</span><span class="n">test</span><span class="o">:</span><span class="n">mytag</span>

<span class="cp"># 列出镜像的历史</span>
<span class="n">docker</span> <span class="n">history</span> <span class="n">ijse</span><span class="o">/</span><span class="n">test</span><span class="o">:</span><span class="n">mytag</span>

<span class="cp"># 登陆官方仓库账户</span>
<span class="n">docker</span> <span class="n">login</span>

<span class="cp"># 修改本地镜像名称</span>
<span class="n">docker</span> <span class="n">rename</span> <span class="n">ijse</span><span class="o">/</span><span class="n">test</span> <span class="n">ijse</span><span class="o">/</span><span class="n">mytest</span>

<span class="cp"># 将镜像推送到仓库中</span>
<span class="n">docker</span> <span class="n">push</span> <span class="n">ijse</span><span class="o">/</span><span class="n">mytest</span><span class="o">:</span><span class="n">mytag</span>

<span class="cp"># 删除一个容器 及其关联的数据卷</span>
<span class="n">docker</span> <span class="n">rm</span> <span class="o">-</span><span class="n">v</span> <span class="mi">23</span><span class="n">ad234</span>

<span class="cp"># 删除一个镜像</span>
<span class="n">docker</span> <span class="n">rmi</span> <span class="n">ubuntu</span>

<span class="cp"># 将本机镜像保存为tar包</span>
<span class="n">docker</span> <span class="n">save</span> <span class="o">-</span><span class="n">o</span> <span class="n">ijse</span><span class="p">.</span><span class="n">test</span><span class="p">.</span><span class="n">tar</span> <span class="n">ijse</span><span class="o">/</span><span class="n">mytest</span>

<span class="cp"># 通过Dockerfile来创建一个镜像</span>
<span class="n">docker</span> <span class="n">build</span> <span class="p">.</span><span class="o">/</span><span class="n">Dockerfile</span>
</pre></div>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>