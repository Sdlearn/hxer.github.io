<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>Selenium and Xvfb  - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Python">Python</a>&nbsp;»&nbsp;Selenium and Xvfb </div>
</div>
<div class="clearfix"></div>
<div id="title">Selenium and Xvfb </div>
  <div id="content">
  <h2 id="reference">reference</h2>
<ul>
<li><a href="http://selenium-python.readthedocs.org/getting-started.html">selenium-python doc</a></li>
</ul>
<h2 id="install">install</h2>
<div class="hlcode"><pre>pip install selenium
</pre></div>


<h2 id="simple-example">simple example</h2>
<div class="hlcode"><pre><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>

<span class="k">class</span> <span class="nc">PythonOrgSearch</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_search_in_python_org</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://www.python.org&quot;</span><span class="p">)</span>     <span class="c1">#visit url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>   <span class="c1"># confirm</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;pycon&quot;</span><span class="p">)</span>         <span class="c1">#input</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s2">&quot;No results found.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">page_source</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>     <span class="c1">#close browser</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>


<ul>
<li>
<p>close vs quit</p>
<ul>
<li>close() </li>
</ul>
<p>close browser</p>
<ul>
<li>quit()</li>
</ul>
<p>close a tab</p>
</li>
<li>
<p>input like human</p>
<ul>
<li>
<p>send_keys(string)</p>
</li>
<li>
<p>click()</p>
</li>
<li>
<p>clear()</p>
</li>
</ul>
</li>
<li>
<p>find element</p>
<ul>
<li>find_element_by_name() vs find_elements_by_name()</li>
</ul>
<p>find_elements_by_name(): return list</p>
<ul>
<li>find_elements()</li>
</ul>
<p><code>python
from selenium.webdriver.common.by import By
webdriver.find_elements(By.NAME, &lt;string&gt;)[0].send_keys(&lt;string&gt;)
webdriver.find_elements(By.XPATH, "//input[@value='&lt;string&gt;']")[0].click()</code></p>
</li>
<li>
<p>Keys class provide keys in the keyboard like RETURN, F1, ALT etc.</p>
</li>
<li>
<p>support browser</p>
</li>
</ul>
<p>Currently supported WebDriver implementations are Firefox, Chrome, Ie and Remote</p>
<ul>
<li>common functions</li>
</ul>
<p>1.获取当前页面的Url函数</p>
<p>方法：current_url</p>
<p>2.获取元素坐标</p>
<p>方法：location</p>
<p>解释：首先查找到你要获取元素的，然后调用location方法</p>
<p>实例：</p>
<p>driver.find_element_by_xpath("//*[@id='tablechart']/tbody/tr[14]/td[9]").location</p>
<p>3.表单的提交</p>
<p>方法：submit</p>
<p>解释:查找到表单（from）直接调用submit即可</p>
<p>实例：</p>
<p>driver.find_element_by_id("form1").submit()</p>
<p>4.获取CSS的属性值</p>
<p>方法：value_of_css_property(css_name)
实例：
driver.find_element_by_css_selector("input.btn").value_of_css_property("input.btn")
5.获取元素的属性值
方法：get_attribute(element_name)
实例：
driver.find_element_by_id("sellaiyuan").get_attribute("sellaiyuan")
6.判断元素是否被选中
方法：is_selected()
实例：
driver.find_element_by_id("form1").is_selected()
7.返回元素的大小
方法：size
实例：
driver.find_element_by_id("iptPassword").size
返回值：{'width': 250, 'height': 30}
8.判断元素是否显示
方法：is_displayed()
实例：
driver.find_element_by_id("iptPassword").is_displayed()
9.判断元素是否被使用
方法：is_enabled()
实例：
driver.find_element_by_id("iptPassword").is_enabled()
10.获取元素的文本值
方法：text
实例：driver.find_element_by_id("iptUsername").text
11.元素赋值
方法：send_keys(*values)
实例：
driver.find_element_by_id("iptUsername").send_keys('admin')
注意如果是函数需要增加转义符u,eg.
driver.find_element_by_id("iptUsername").send_keys(u'青春')
12.返回元素的tagName
方法：tag_name
实例：
driver.find_element_by_id("iptUsername").tag_name
13.删除浏览器所以的cookies
方法：delete_all_cookies()
实例：
driver.delete_all_cookies()
14.删除指定的cookie
方法：delete_cookie(name)
实例：deriver.delete_cookie("my_cookie_name")
15.关闭浏览器
方法：close()
实例：driver.close()
16.关闭浏览器并且推出驱动程序
方法：quit()
实例：driver.quit()
17.返回上一页
方法：back()
实例：driver.back()
18.设置等待超时
方法：implicitly_wait(wait_time)
实例：driver.implicitly_wait(30)
19.浏览器窗口最大化
方法：maximize_window()
实例：driver.maximize_window()
20.查看浏览器的名字
方法：name
实例：drvier.name</p>
<h1 id="xvfb">Xvfb</h1>
<p>It is an X11 server that performs all graphical operations in memory, not showing any screen output</p>
<p>Only a network layer is necessary.</p>
<h2 id="install_1">install</h2>
<div class="hlcode"><pre>System Requirements:

sudo apt-get install xvfb   # or similar)
pip install xvfbwrapper
</pre></div>


<h2 id="example">example</h2>
<div class="hlcode"><pre><span class="kn">import</span> <span class="nn">unittest</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">xvfbwrapper</span> <span class="kn">import</span> <span class="n">Xvfb</span>


<span class="k">class</span> <span class="nc">TestPages</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xvfb</span> <span class="o">=</span> <span class="n">Xvfb</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1280</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">720</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xvfb</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xvfb</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">testUbuntuHomepage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.ubuntu.com&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;Ubuntu&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>