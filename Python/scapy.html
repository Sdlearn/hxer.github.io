<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>Scapy - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Python">Python</a>&nbsp;»&nbsp;Scapy</div>
</div>
<div class="clearfix"></div>
<div id="title">Scapy</div>
  <div id="content">
  <h1 id="dns">DNS</h1>
<h2 id="ip-reverse-ip-domain-check">IP反向查询域名 Reverse IP Domain Check</h2>
<h1 id="arp">ARP</h1>
<h2 id="arp-scan">ARP scan</h2>
<p>局域网主机探测扫描，含有线或无线局域网</p>
<p>方式1 ARP请求</p>
<div class="hlcode"><pre><span class="p">$</span><span class="nv">sudo</span><span class="x"> scapy</span>

<span class="x">&gt;pkt=Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;)/ARP(hwtype=1,ptype=0x0800,op=1,pdst=&quot;192.168.199.0/24&quot;)</span>

<span class="x">&gt;srp(pkt,timeout=5)</span>

<span class="x">Begin emission:</span>
<span class="x">Finished to send 256 packets.</span>
<span class="x">.......</span>
<span class="x">Received 7 packets, got 0 answers, remaining 256 packets</span>
<span class="x">(&lt;Results: TCP:0 UDP:0 ICMP:0 Other:0&gt;, &lt;Unanswered: TCP:0 UDP:0 ICMP:0 Other:256&gt;)</span>

<span class="x">&gt;ans,unans=_</span>

<span class="x">&gt;ans.summary(lambda(s,r):r.sprintf(&quot;%Ehter.src%:%ARP.psrc%&quot;))</span>

<span class="x">??:192.168.199.1</span>
</pre></div>


<p>opcode:1(请求包)
hardware type:1(以太网)
protocol type:0x0800(IP)</p>
<h2 id="send-receive">send &amp; receive</h2>
<div class="hlcode"><pre>sr()
-- The sr() function is for sending packets and receiving answers. The function returns
a couple of packet and answers, and the unanswered packets.

sr1() 
-- This function is a variant that only returns one packet that answered the sent
packet (or the packet set) sent.

srp()
-- The function srp() does the same for layer 2 packets (Ethernet, 802.3, etc).
</pre></div>


<h2 id="_1">构造数据包常用参数</h2>
<ul>
<li>IP()</li>
</ul>
<div class="hlcode"><pre>src   e.g. src=&quot;192.168.222.222&quot;
dst   e.g. dst=&quot;192.168.0.1&quot;
ttl   e.g. ttl=64 
</pre></div>


<ul>
<li>ICMP()</li>
</ul>
<div class="hlcode"><pre>type   e.g. type=8(Echo (ping) request)
                 0(Echo (ping) reply)
</pre></div>


<ul>
<li>TCP()</li>
</ul>
<div class="hlcode"><pre>sport
dport   e.g. dport=80, [22,23,80]
flags   e.g. flags=&quot;S&quot;--SYN
inter
retry
timeout
</pre></div>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>