<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>scapy - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Python">Python</a>&nbsp;»&nbsp;scapy</div>
</div>
<div class="clearfix"></div>
<div id="title">scapy</div>
  <div id="content">
  <h1 id="dns">DNS</h1>
<h2 id="ip-reverse-ip-domain-check">IP反向查询域名 Reverse IP Domain Check</h2>
<h1 id="arp">ARP</h1>
<h2 id="arp-scan">ARP scan</h2>
<p>局域网主机探测扫描，含有线或无线局域网</p>
<p>方式1 ARP请求</p>
<div class="hlcode"><pre><span class="err">$</span><span class="n">sudo</span> <span class="n">scapy</span>

<span class="o">&gt;</span><span class="n">pkt</span><span class="o">=</span><span class="n">Ether</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s">&quot;ff:ff:ff:ff:ff:ff&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">ARP</span><span class="p">(</span><span class="n">hwtype</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ptype</span><span class="o">=</span><span class="mh">0x0800</span><span class="p">,</span><span class="n">op</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">pdst</span><span class="o">=</span><span class="s">&quot;192.168.199.0/24&quot;</span><span class="p">)</span>

<span class="o">&gt;</span><span class="n">srp</span><span class="p">(</span><span class="n">pkt</span><span class="p">,</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">Begin</span> <span class="n">emission</span><span class="o">:</span>
<span class="n">Finished</span> <span class="n">to</span> <span class="n">send</span> <span class="mi">256</span> <span class="n">packets</span><span class="p">.</span>
<span class="p">.......</span>
<span class="n">Received</span> <span class="mi">7</span> <span class="n">packets</span><span class="p">,</span> <span class="n">got</span> <span class="mi">0</span> <span class="n">answers</span><span class="p">,</span> <span class="n">remaining</span> <span class="mi">256</span> <span class="n">packets</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">Results</span><span class="o">:</span> <span class="n">TCP</span><span class="o">:</span><span class="mi">0</span> <span class="n">UDP</span><span class="o">:</span><span class="mi">0</span> <span class="n">ICMP</span><span class="o">:</span><span class="mi">0</span> <span class="n">Other</span><span class="o">:</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">Unanswered</span><span class="o">:</span> <span class="n">TCP</span><span class="o">:</span><span class="mi">0</span> <span class="n">UDP</span><span class="o">:</span><span class="mi">0</span> <span class="n">ICMP</span><span class="o">:</span><span class="mi">0</span> <span class="n">Other</span><span class="o">:</span><span class="mi">256</span><span class="o">&gt;</span><span class="p">)</span>

<span class="o">&gt;</span><span class="n">ans</span><span class="p">,</span><span class="n">unans</span><span class="o">=</span><span class="n">_</span>

<span class="o">&gt;</span><span class="n">ans</span><span class="p">.</span><span class="n">summary</span><span class="p">(</span><span class="n">lambda</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">:</span><span class="n">r</span><span class="p">.</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&quot;%Ehter.src%:%ARP.psrc%&quot;</span><span class="p">))</span>

<span class="o">??:</span><span class="mf">192.168.199.1</span>
</pre></div>


<p>opcode:1(请求包)
hardware type:1(以太网)
protocol type:0x0800(IP)</p>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>