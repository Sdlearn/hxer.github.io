<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>AttackTool - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#WebSecurity">WebSecurity</a>&nbsp;»&nbsp;AttackTool</div>
</div>
<div class="clearfix"></div>
<div id="title">AttackTool</div>
  <div id="content">
  <h2 id="nikto">Nikto</h2>
<p>Nikto Web Scanner is a Web server scanner that tests Web servers for dangerous files/CGIs, outdated server software and other problems.</p>
<h1 id="brute-force">Brute Force</h1>
<h2 id="_1">字典</h2>
<div class="hlcode"><pre>metasploit  /usr/share/metasploit-framework/data/john/wordlists/password.lst
</pre></div>


<h2 id="php-mt_rand-seed-crack">php mt_rand seed crack</h2>
<p>tool:</p>
<ul>
<li><a href="http://www.openwall.com/php_mt_seed/">php_mt_seed</a></li>
</ul>
<p>样例:</p>
<p><a href="https://github.com/pwning/public-writeup/tree/master/hitcon2015/web300-giraffes-coffee">hitcon 2015 web300</a></p>
<p>mt_rand rainbow:</p>
<p><a href="http://www.gat3way.eu/poc/wtrt/">mt_rand rainbow</a></p>
<h2 id="hydra">hydra</h2>
<ul>
<li>option</li>
</ul>
<div class="hlcode"><pre>-R          继续从上一次进度接着破解
-S          采用SSL链接
-s &lt;PORT&gt;   可通过这个参数指定非默认端口
-l &lt;LOGIN&gt;  指定破解的用户，对特定用户破解
-L &lt;FILE&gt;   指定用户名字典
-p &lt;PASS&gt;   指定密码破解，少用，一般是采用密码字典
-P &lt;FILE&gt;   指定密码字典
-e &lt;nsr&gt;     额外可选选项，n (空密碼，即不指定密碼)， s (將帳號同時當成密碼用)，r (將帳號/密碼調換使用)
-C &lt;FILE&gt;   使用冒号分割格式，例如“登录名:密码”来代替-L/-P参数
-M &lt;FILE&gt;   指定目标列表文件一行一条
-o &lt;FILE&gt;   指定结果输出文件
-f          在使用-M参数以后，找到第一对登录名或者密码的时候中止破解
-t &lt;TASKS&gt;  同时运行的线程数，默认为16
-w &lt;TIME&gt;   设置最大超时的时间，单位秒，默认是30s
-v / -V     显示详细过程
-SuvVd46：是多個選項的組合，分別表示：
    S：使用SSL連線
    u：每一組密碼都用帳號輪流測試，而不是每一組帳號用密碼輪流測試。
    v V d U 是訊息的詳細度
    4 6 是 IP address 格式(IPv4 或 IPv6)
server      目标ip
service     指定服务名，支持的服务和协议：telnet ftp pop3[-ntlm] imap[-ntlm] smb smbnt http[s]-{head|get} http-{get|post}-form http-proxy cisco cisco-enable vnc ldap2 ldap3 mssql mysql oracle-listener postgres nntp socks5 rexec rlogin pcnfs snmp rsh cvs svn icq sapr3 ssh2 smtp-auth[-ntlm] pcanywhere teamspeak sip vmauthd firebird ncp afp等等
</pre></div>


<ul>
<li>use</li>
</ul>
<p>http post form attack</p>
<div class="hlcode"><pre><span class="nt">hydra</span> <span class="nt">-l</span> <span class="nt">admin</span> <span class="nt">-P</span> <span class="nt">pass</span><span class="nc">.lst</span> <span class="nt">-o</span> <span class="nt">ok</span><span class="nc">.lst</span> <span class="nt">-t</span> <span class="nt">1</span> <span class="nt">-f</span> <span class="nt">127</span><span class="nc">.0.0.1</span> <span class="nt">http-post-form</span> <span class="err">“</span><span class="o">/</span><span class="nt">login</span><span class="nc">.php</span><span class="nd">:name</span><span class="o">=^</span><span class="nt">USER</span><span class="o">^&amp;</span><span class="nt">pwd</span><span class="o">=^</span><span class="nt">PASS</span><span class="o">^</span><span class="nd">:incorrect:H</span><span class="o">=</span><span class="nt">Cookie</span><span class="o">:</span> <span class="nt">security</span><span class="o">=</span><span class="nt">low</span><span class="o">;</span> <span class="nt">PHPSESSID</span><span class="o">=</span><span class="nt">o7qiqd9fc1d003u9d38k64t0f4</span><span class="err">”</span>
</pre></div>


<blockquote>
<p>http-post-form or http-get-form</p>
<p>incorrect表示错误猜解的返回信息提示，自定义,最好和页面返回的信息一致，不要略写，不然可能产生错报，具体原因待去看源码</p>
</blockquote>
<p><strong>:H= 表示手工设置的Header</strong></p>
<h2 id="htpwdscan">htpwdScan</h2>
<p><a href="https://github.com/lijiejie/htpwdScan">github htpwdScan</a></p>
<ul>
<li>install</li>
</ul>
<div class="hlcode"><pre>cd ~/ctf
git clone https://github.com/lijiejie/htpwdScan.git
cd htpwdScan
chmod u+x
sudo ln -s ~/ctf/htpwdScan/htpwdScan.py /usr/local/bin/htpwdscan    #cofirm htpwdScan.py begin with &quot;#!/usr/bin/env python&quot;
htpwdscan -h    # to run
</pre></div>


<ul>
<li>use</li>
</ul>
<p>先用 -debug 查看 request and response， after confirming, then crack </p>
<p>htpwdScan.py 默认使用 htpp post method， if use get, use -get</p>
<p>脚本会自动替换\r \n \t等空白字符</p>
<p><strong>http get crack</strong></p>
<div class="hlcode"><pre>htpwdscan -f http_get.txt -d username=top_shortlist_name.txt password=10k_most_common_passwd.txt -get -err=&quot;Username and/or password incorrect&quot;
</pre></div>


<blockquote>
<p>http_get.txt -- use brupsuite get http request, save to file</p>
</blockquote>
<div class="hlcode"><pre><span class="nf">GET</span> <span class="nn">/dvwa/vulnerabilities/brute/?Login=Login</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">localhost</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux x86_64; rv:43.0) Gecko/20100101 Firefox/43.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Referer</span><span class="o">:</span> <span class="l">http://localhost/dvwa/vulnerabilities/brute/</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">security=low; PHPSESSID=ij8gd7u55olpvsd39r0ki35cb1</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
</pre></div>


<p>http proxy check</p>
<div class="hlcode"><pre>htpwdscan -u=http://www.baidu.com -get -proxylist=available.txt -checkproxy -suc=&quot;百度一下&quot;

# or check by website that to crack
htpwdscan -f=post.txt -proxylist=proxies.txt -checkproxy -suc=&quot;用户名或密码错误&quot; 
</pre></div>


<h2 id="burpsuite">burpsuite</h2>
<p><a href="http://drops.wooyun.org/tools/1548">乌云 Brup使用介绍</a></p>
<p>检测模式</p>
<p>sniper  -- payload 数为1</p>
<div class="hlcode"><pre>----- username/password -------- sniper {%username%---表示测试变量，也就是字典值}
-----%username%/password
-----username/%password%
</pre></div>


<p>battering ram -- payload 数为1    </p>
<div class="hlcode"><pre>------username/password ------- battering ram 测试
------%username%=%password%
</pre></div>


<p>pitchfork</p>
<div class="hlcode"><pre>-----username/password ------- pitchfork 测试
</pre></div>


<p>cluster bomb</p>
<div class="hlcode"><pre>-------username/password ---------- cluster bomb 测试
</pre></div>


<h2 id="webscarab">webscarab</h2>
<h2 id="cewl-custom-word-list-generator">CeWL - Custom Word List generator</h2>
<h1 id="sql">SQL</h1>
<h2 id="sqlmap">sqlmap</h2>
<p>sqlmap.py -u url --dbms                 爆后端数据库
sqlmap.py -u url --dbms "数据库名" --dbs 
sqlmap.py -u url --dbms "数据库名" --tables              爆数据库表
sqlmap.py -u url --dbms "数据库名" --current-db             显示当前连接数据库名
sqlmap.py -u url --dbms "数据库名" --tables  -D "数据库名"                   列出数据库表中的表名
sqlmap.py -u url --dbms "数据库名" --columns  -T "表名" -D "数据库名"         列出数据库名中的表名内容
sqlmap.py -u url --dbms "数据库名" --dump  -C "字段,字段"  -T "表名" -D "数据库名"       获取字段里面的内容</p>
<ul>
<li>option</li>
</ul>
<div class="hlcode"><pre>-r &lt;filename&gt;
&gt; sqlmap -r login.txt
</pre></div>


<p>txt文件</p>
<div class="hlcode"><pre>+ burpsuite 保存的文件

+ 自己构造

```
POST /vuln.php HTTP/1.1
Host: www.target.com
User-Agent: Mozilla/4.0

id=1
```
</pre></div>


<ul>
<li>大量出现 unable to connect ，表明流量被WAF拦截</li>
</ul>
<p>1 使用tamper </p>
<p>2
--user-agent "Googlebot (http://www.google.com/)
--user-agent="Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0"</p>
<p>3 设置延迟时间或线程数
--threads 线程数
--delay 延迟</p>
<h3 id="waf-tamper">绕过 waf 的tamper</h3>
<ol>
<li>
<p>apostrophemask.py        用UTF-8全角字符替换单引号字符</p>
</li>
<li>
<p>apostrophenullencode.py        用非法双字节unicode字符替换单引号字符</p>
</li>
<li>
<p>appendnullbyte.py        在payload末尾添加空字符编码</p>
</li>
<li>
<p>base64encode.py        对给定的payload全部字符使用Base64编码</p>
</li>
<li>
<p>between.py        分别用“NOT BETWEEN 0 AND #”替换大于号“&gt;”，“BETWEEN # AND #”替换等于号“=”</p>
</li>
<li>
<p>bluecoat.py        在SQL语句之后用有效的随机空白符替换空格符，随后用“LIKE”替换等于号“=”</p>
</li>
<li>
<p>chardoubleencode.py        对给定的payload全部字符使用双重URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>charencode.py        对给定的payload全部字符使用URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>charunicodeencode.py        对给定的payload的非编码字符使用Unicode URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>concat2concatws.py        用“CONCAT_WS(MID(CHAR(0), 0, 0), A, B)”替换像“CONCAT(A, B)”的实例</p>
</li>
<li>
<p>equaltolike.py        用“LIKE”运算符替换全部等于号“=”</p>
</li>
<li>
<p>greatest.py        用“GREATEST”函数替换大于号“&gt;”</p>
</li>
<li>
<p>halfversionedmorekeywords.py        在每个关键字之前添加MySQL注释</p>
</li>
<li>
<p>ifnull2ifisnull.py        用“IF(ISNULL(A), B, A)”替换像“IFNULL(A, B)”的实例</p>
</li>
<li>
<p>lowercase.py        用小写值替换每个关键字字符</p>
</li>
<li>
<p>modsecurityversioned.py        用注释包围完整的查询</p>
</li>
<li>
<p>modsecurityzeroversioned.py        用当中带有数字零的注释包围完整的查询</p>
</li>
<li>
<p>multiplespaces.py        在SQL关键字周围添加多个空格</p>
</li>
<li>
<p>nonrecursivereplacement.py        用representations替换预定义SQL关键字，适用于过滤器</p>
</li>
<li>
<p>overlongutf8.py        转换给定的payload当中的所有字符</p>
</li>
<li>
<p>percentage.py        在每个字符之前添加一个百分号</p>
</li>
<li>
<p>randomcase.py        随机转换每个关键字字符的大小写</p>
</li>
<li>
<p>randomcomments.py        向SQL关键字中插入随机注释</p>
</li>
<li>
<p>securesphere.py        添加经过特殊构造的字符串</p>
</li>
<li>
<p>sp_password.py        向payload末尾添加“sp_password” for automatic obfuscation from DBMS logs</p>
</li>
<li>
<p>space2comment.py        用“/**/”替换空格符</p>
</li>
<li>
<p>space2dash.py        用破折号注释符“--”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2hash.py        用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2morehash.py        用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2mssqlblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>space2mssqlhash.py        用磅注释符“#”其次是一个换行符替换空格符</p>
</li>
<li>
<p>space2mysqlblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>space2mysqldash.py        用破折号注释符“--”其次是一个换行符替换空格符</p>
</li>
<li>
<p>space2plus.py        用加号“+”替换空格符</p>
</li>
<li>
<p>space2randomblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>unionalltounion.py        用“UNION SELECT”替换“UNION ALL SELECT”</p>
</li>
<li>
<p>unmagicquotes.py        用一个多字节组合%bf%27和末尾通用注释一起替换空格符</p>
</li>
<li>
<p>varnish.py        添加一个HTTP头“X-originating-IP”来绕过WAF</p>
</li>
<li>
<p>versionedkeywords.py        用MySQL注释包围每个非函数关键字</p>
</li>
<li>
<p>versionedmorekeywords.py        用MySQL注释包围每个关键字</p>
</li>
<li>
<p>xforwardedfor.py        添加一个伪造的HTTP头“X-Forwarded-For”来绕过WAF</p>
</li>
</ol>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>