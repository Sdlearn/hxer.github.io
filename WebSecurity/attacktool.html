<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>AttackTool - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#WebSecurity">WebSecurity</a>&nbsp;»&nbsp;AttackTool</div>
</div>
<div class="clearfix"></div>
<div id="title">AttackTool</div>
  <div id="content">
  <h2 id="nikto">Nikto</h2>
<p>Nikto Web Scanner is a Web server scanner that tests Web servers for dangerous files/CGIs, outdated server software and other problems.</p>
<h1 id="brute-force">Brute Force</h1>
<h2 id="_1">字典</h2>
<div class="hlcode"><pre><span class="n">metasploit</span>  <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">john</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">password</span><span class="p">.</span><span class="n">lst</span>
</pre></div>


<h2 id="php-mt_rand-seed-crack">php mt_rand seed crack</h2>
<p>tool:</p>
<ul>
<li><a href="http://www.openwall.com/php_mt_seed/">php_mt_seed</a></li>
</ul>
<p>样例:</p>
<p><a href="https://github.com/pwning/public-writeup/tree/master/hitcon2015/web300-giraffes-coffee">hitcon 2015 web300</a></p>
<p>mt_rand rainbow:</p>
<p><a href="http://www.gat3way.eu/poc/wtrt/">mt_rand rainbow</a></p>
<h2 id="hydra">hydra</h2>
<ul>
<li>option</li>
</ul>
<div class="hlcode"><pre><span class="na">-R</span>          <span class="err">继续从上一次进度接着破解</span>
<span class="na">-S</span>          <span class="err">采用</span><span class="nx">SSL</span><span class="err">链接</span>
<span class="na">-s</span> <span class="o">&lt;</span><span class="nb">PORT</span><span class="o">&gt;</span>   <span class="err">可通过这个参数指定非默认端口</span>
<span class="na">-l</span> <span class="o">&lt;</span><span class="nx">LOGIN</span><span class="o">&gt;</span>  <span class="err">指定破解的用户，对特定用户破解</span>
<span class="na">-L</span> <span class="o">&lt;</span><span class="nb">FILE</span><span class="o">&gt;</span>   <span class="err">指定用户名字典</span>
<span class="na">-p</span> <span class="o">&lt;</span><span class="nb">PASS</span><span class="o">&gt;</span>   <span class="err">指定密码破解，少用，一般是采用密码字典</span>
<span class="na">-P</span> <span class="o">&lt;</span><span class="nb">FILE</span><span class="o">&gt;</span>   <span class="err">指定密码字典</span>
<span class="na">-e</span> <span class="o">&lt;</span><span class="nx">nsr</span><span class="o">&gt;</span>     <span class="err">额外可选选项，</span><span class="nb">n</span> <span class="p">(</span><span class="err">空密碼，即不指定密碼</span><span class="p">)</span><span class="err">，</span> <span class="nb">s</span> <span class="p">(</span><span class="err">將帳號同時當成密碼用</span><span class="p">)</span><span class="err">，</span><span class="nb">r</span> <span class="p">(</span><span class="err">將帳號</span><span class="o">/</span><span class="err">密碼調換使用</span><span class="p">)</span>
<span class="na">-C</span> <span class="o">&lt;</span><span class="nb">FILE</span><span class="o">&gt;</span>   <span class="err">使用冒号分割格式，例如“登录名</span><span class="p">:</span><span class="err">密码”来代替</span><span class="na">-L</span><span class="o">/-</span><span class="nx">P</span><span class="err">参数</span>
<span class="na">-M</span> <span class="o">&lt;</span><span class="nb">FILE</span><span class="o">&gt;</span>   <span class="err">指定目标列表文件一行一条</span>
<span class="na">-o</span> <span class="o">&lt;</span><span class="nb">FILE</span><span class="o">&gt;</span>   <span class="err">指定结果输出文件</span>
<span class="na">-f</span>          <span class="err">在使用</span><span class="na">-M</span><span class="err">参数以后，找到第一对登录名或者密码的时候中止破解</span>
<span class="na">-t</span> <span class="o">&lt;</span><span class="nb">TASKS</span><span class="o">&gt;</span>  <span class="err">同时运行的线程数，默认为</span><span class="mi">16</span>
<span class="na">-w</span> <span class="o">&lt;</span><span class="nb">TIME</span><span class="o">&gt;</span>   <span class="err">设置最大超时的时间，单位秒，默认是</span><span class="mi">30</span><span class="nb">s</span>
<span class="na">-v</span> <span class="o">/</span> <span class="na">-V</span>     <span class="err">显示详细过程</span>
<span class="na">-SuvVd46</span><span class="err">：是多個選項的組合，分別表示：</span>
    <span class="nb">S</span><span class="err">：使用</span><span class="nx">SSL</span><span class="err">連線</span>
    <span class="nx">u</span><span class="err">：每一組密碼都用帳號輪流測試，而不是每一組帳號用密碼輪流測試。</span>
    <span class="nx">v</span> <span class="nx">V</span> <span class="nb">d</span> <span class="nx">U</span> <span class="err">是訊息的詳細度</span>
    <span class="mi">4</span> <span class="mi">6</span> <span class="err">是</span> <span class="nx">IP</span> <span class="nx">address</span> <span class="err">格式</span><span class="p">(</span><span class="nx">IPv4</span> <span class="err">或</span> <span class="nx">IPv6</span><span class="p">)</span>
<span class="nx">server</span>      <span class="err">目标</span><span class="nx">ip</span>
<span class="nx">service</span>     <span class="err">指定服务名，支持的服务和协议：</span><span class="nx">telnet</span> <span class="nx">ftp</span> <span class="nx">pop3</span><span class="err">[</span><span class="na">-ntlm</span><span class="cp">]</span> imap<span class="cp">[</span><span class="na">-ntlm</span><span class="cp">]</span> smb smbnt http<span class="cp">[</span><span class="nb">s</span><span class="cp">]</span>-{head|get} http-{get|post}-form http-proxy cisco cisco-enable vnc ldap2 ldap3 mssql mysql oracle-listener postgres nntp socks5 rexec rlogin pcnfs snmp rsh cvs svn icq sapr3 ssh2 smtp-auth<span class="cp">[</span><span class="na">-ntlm</span><span class="cp">]</span> pcanywhere teamspeak sip vmauthd firebird ncp afp等等
</pre></div>


<h3 id="use">use</h3>
<ul>
<li>ssh</li>
</ul>
<div class="hlcode"><pre><span class="n">hydra</span> <span class="n">ip</span> <span class="o">-</span><span class="n">l</span> <span class="n">root</span> <span class="o">-</span><span class="n">P</span> <span class="n">pass</span><span class="p">.</span><span class="n">lst</span>
</pre></div>


<ul>
<li>http post form attack</li>
</ul>
<div class="hlcode"><pre><span class="n">hydra</span> <span class="o">-</span><span class="n">l</span> <span class="n">admin</span> <span class="o">-</span><span class="n">P</span> <span class="n">pass</span><span class="p">.</span><span class="n">lst</span> <span class="o">-</span><span class="n">o</span> <span class="n">ok</span><span class="p">.</span><span class="n">lst</span> <span class="o">-</span><span class="n">t</span> <span class="mi">1</span> <span class="o">-</span><span class="n">f</span> <span class="mf">127.0.0.1</span> <span class="n">http</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span> <span class="err">“</span><span class="o">/</span><span class="n">login</span><span class="p">.</span><span class="n">php</span><span class="o">:</span><span class="n">name</span><span class="o">=^</span><span class="n">USER</span><span class="o">^&amp;</span><span class="n">pwd</span><span class="o">=^</span><span class="n">PASS</span><span class="o">^:</span><span class="n">incorrect</span><span class="o">:</span><span class="n">H</span><span class="o">=</span><span class="n">Cookie</span><span class="o">:</span> <span class="n">security</span><span class="o">=</span><span class="n">low</span><span class="p">;</span> <span class="n">PHPSESSID</span><span class="o">=</span><span class="n">o7qiqd9fc1d003u9d38k64t0f4</span><span class="err">”</span>
</pre></div>


<blockquote>
<p>http-post-form or http-get-form</p>
<p>incorrect表示错误猜解的返回信息提示，自定义,最好和页面返回的信息一致，不要略写，不然可能产生错报，具体原因待去看源码</p>
</blockquote>
<p><strong>:H= 表示手工设置的Header</strong></p>
<h2 id="htpwdscan">htpwdScan</h2>
<p><a href="https://github.com/lijiejie/htpwdScan">github htpwdScan</a></p>
<ul>
<li>install</li>
</ul>
<div class="hlcode"><pre><span class="n">cd</span> <span class="o">~/</span><span class="n">ctf</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="o">:</span><span class="c1">//github.com/lijiejie/htpwdScan.git</span>
<span class="n">cd</span> <span class="n">htpwdScan</span>
<span class="n">chmod</span> <span class="n">u</span><span class="o">+</span><span class="n">x</span>
<span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">~/</span><span class="n">ctf</span><span class="o">/</span><span class="n">htpwdScan</span><span class="o">/</span><span class="n">htpwdScan</span><span class="p">.</span><span class="n">py</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">htpwdscan</span>    <span class="err">#</span><span class="n">cofirm</span> <span class="n">htpwdScan</span><span class="p">.</span><span class="n">py</span> <span class="n">begin</span> <span class="n">with</span> <span class="s">&quot;#!/usr/bin/env python&quot;</span>
<span class="n">htpwdscan</span> <span class="o">-</span><span class="n">h</span>    <span class="err">#</span> <span class="n">to</span> <span class="n">run</span>
</pre></div>


<ul>
<li>use</li>
</ul>
<p>先用 -debug 查看 request and response， after confirming, then crack </p>
<p>htpwdScan.py 默认使用 htpp post method， if use get, use -get</p>
<p>脚本会自动替换\r \n \t等空白字符</p>
<p><strong>http get crack</strong></p>
<div class="hlcode"><pre><span class="n">htpwdscan</span> <span class="o">-</span><span class="n">f</span> <span class="n">http_get</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">d</span> <span class="n">username</span><span class="o">=</span><span class="n">top_shortlist_name</span><span class="p">.</span><span class="n">txt</span> <span class="n">password</span><span class="o">=</span><span class="mi">10</span><span class="n">k_most_common_passwd</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">err</span><span class="o">=</span><span class="s">&quot;Username and/or password incorrect&quot;</span>
</pre></div>


<blockquote>
<p>http_get.txt -- use brupsuite get http request, save to file</p>
</blockquote>
<div class="hlcode"><pre><span class="n">GET</span> <span class="o">/</span><span class="n">dvwa</span><span class="o">/</span><span class="n">vulnerabilities</span><span class="o">/</span><span class="n">brute</span><span class="o">/?</span><span class="n">Login</span><span class="o">=</span><span class="n">Login</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nl">Host:</span> <span class="n">localhost</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="o">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">X11</span><span class="p">;</span> <span class="n">Linux</span> <span class="n">x86_64</span><span class="p">;</span> <span class="n">rv</span><span class="o">:</span><span class="mf">43.0</span><span class="p">)</span> <span class="n">Gecko</span><span class="o">/</span><span class="mi">20100101</span> <span class="n">Firefox</span><span class="o">/</span><span class="mf">43.0</span>
<span class="nl">Accept:</span> <span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="n">xhtml</span><span class="o">+</span><span class="n">xml</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="n">xml</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="err">*/</span><span class="o">*</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.8</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="o">:</span> <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="o">:</span> <span class="n">gzip</span><span class="p">,</span> <span class="n">deflate</span>
<span class="nl">Referer:</span> <span class="n">http</span><span class="o">:</span><span class="c1">//localhost/dvwa/vulnerabilities/brute/</span>
<span class="nl">Cookie:</span> <span class="n">security</span><span class="o">=</span><span class="n">low</span><span class="p">;</span> <span class="n">PHPSESSID</span><span class="o">=</span><span class="n">ij8gd7u55olpvsd39r0ki35cb1</span>
<span class="nl">Connection:</span> <span class="n">close</span>
</pre></div>


<p>http proxy check</p>
<div class="hlcode"><pre><span class="n">htpwdscan</span> <span class="o">-</span><span class="n">u</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.baidu.com -get -proxylist=available.txt -checkproxy -suc=&quot;百度一下&quot;</span>

<span class="cp"># or check by website that to crack</span>
<span class="n">htpwdscan</span> <span class="o">-</span><span class="n">f</span><span class="o">=</span><span class="n">post</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">proxylist</span><span class="o">=</span><span class="n">proxies</span><span class="p">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">checkproxy</span> <span class="o">-</span><span class="n">suc</span><span class="o">=</span><span class="s">&quot;用户名或密码错误&quot;</span> 
</pre></div>


<h2 id="burpsuite">burpsuite</h2>
<p><a href="http://drops.wooyun.org/tools/1548">乌云 Brup使用介绍</a></p>
<p>检测模式</p>
<p>sniper  -- payload 数为1</p>
<div class="hlcode"><pre><span class="o">-----</span> <span class="n">username</span><span class="o">/</span><span class="n">password</span> <span class="o">--------</span> <span class="n">sniper</span> <span class="p">{</span><span class="o">%</span><span class="n">username</span><span class="o">%---</span><span class="err">表示测试变量，也就是字典值</span><span class="p">}</span>
<span class="o">-----%</span><span class="n">username</span><span class="o">%/</span><span class="n">password</span>
<span class="o">-----</span><span class="n">username</span><span class="o">/%</span><span class="n">password</span><span class="o">%</span>
</pre></div>


<p>battering ram -- payload 数为1    </p>
<div class="hlcode"><pre><span class="o">------</span><span class="n">username</span><span class="o">/</span><span class="n">password</span> <span class="o">-------</span> <span class="n">battering</span> <span class="n">ram</span> <span class="err">测试</span>
<span class="o">------%</span><span class="n">username</span><span class="o">%=%</span><span class="n">password</span><span class="o">%</span>
</pre></div>


<p>pitchfork</p>
<div class="hlcode"><pre><span class="o">-----</span><span class="n">username</span><span class="o">/</span><span class="n">password</span> <span class="o">-------</span> <span class="n">pitchfork</span> <span class="err">测试</span>
</pre></div>


<p>cluster bomb</p>
<div class="hlcode"><pre><span class="o">-------</span><span class="n">username</span><span class="o">/</span><span class="n">password</span> <span class="o">----------</span> <span class="n">cluster</span> <span class="n">bomb</span> <span class="err">测试</span>
</pre></div>


<h2 id="webscarab">webscarab</h2>
<h2 id="cewl-custom-word-list-generator">CeWL - Custom Word List generator</h2>
<h1 id="sql">SQL</h1>
<h2 id="sqlmap">sqlmap</h2>
<p>sqlmap.py -u url --dbms                 爆后端数据库
sqlmap.py -u url --dbms "数据库名" --dbs 
sqlmap.py -u url --dbms "数据库名" --tables              爆数据库表
sqlmap.py -u url --dbms "数据库名" --current-db             显示当前连接数据库名
sqlmap.py -u url --dbms "数据库名" --tables  -D "数据库名"                   列出数据库表中的表名
sqlmap.py -u url --dbms "数据库名" --columns  -T "表名" -D "数据库名"         列出数据库名中的表名内容
sqlmap.py -u url --dbms "数据库名" --dump  -C "字段,字段"  -T "表名" -D "数据库名"       获取字段里面的内容</p>
<ul>
<li>option</li>
</ul>
<div class="hlcode"><pre><span class="na">-r</span> <span class="o">&lt;</span><span class="nb">filename</span><span class="o">&gt;</span>
<span class="o">&gt;</span> <span class="nx">sqlmap</span> <span class="na">-r</span> <span class="nx">login.txt</span>
</pre></div>


<p>txt文件</p>
<div class="hlcode"><pre><span class="o">+</span> <span class="n">burpsuite</span> <span class="err">保存的文件</span>

<span class="o">+</span> <span class="err">自己构造</span>

<span class="err">```</span>
<span class="n">POST</span> <span class="o">/</span><span class="n">vuln</span><span class="p">.</span><span class="n">php</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nl">Host:</span> <span class="n">www</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">com</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="o">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">4.0</span>

<span class="n">id</span><span class="o">=</span><span class="mi">1</span>
<span class="err">```</span>
</pre></div>


<ul>
<li>大量出现 unable to connect ，表明流量被WAF拦截</li>
</ul>
<p>1 使用tamper </p>
<p>2
--user-agent "Googlebot (http://www.google.com/)
--user-agent="Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0"</p>
<p>3 设置延迟时间或线程数
--threads 线程数
--delay 延迟</p>
<h3 id="waf-tamper">绕过 waf 的tamper</h3>
<ol>
<li>
<p>apostrophemask.py        用UTF-8全角字符替换单引号字符</p>
</li>
<li>
<p>apostrophenullencode.py        用非法双字节unicode字符替换单引号字符</p>
</li>
<li>
<p>appendnullbyte.py        在payload末尾添加空字符编码</p>
</li>
<li>
<p>base64encode.py        对给定的payload全部字符使用Base64编码</p>
</li>
<li>
<p>between.py        分别用“NOT BETWEEN 0 AND #”替换大于号“&gt;”，“BETWEEN # AND #”替换等于号“=”</p>
</li>
<li>
<p>bluecoat.py        在SQL语句之后用有效的随机空白符替换空格符，随后用“LIKE”替换等于号“=”</p>
</li>
<li>
<p>chardoubleencode.py        对给定的payload全部字符使用双重URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>charencode.py        对给定的payload全部字符使用URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>charunicodeencode.py        对给定的payload的非编码字符使用Unicode URL编码（不处理已经编码的字符）</p>
</li>
<li>
<p>concat2concatws.py        用“CONCAT_WS(MID(CHAR(0), 0, 0), A, B)”替换像“CONCAT(A, B)”的实例</p>
</li>
<li>
<p>equaltolike.py        用“LIKE”运算符替换全部等于号“=”</p>
</li>
<li>
<p>greatest.py        用“GREATEST”函数替换大于号“&gt;”</p>
</li>
<li>
<p>halfversionedmorekeywords.py        在每个关键字之前添加MySQL注释</p>
</li>
<li>
<p>ifnull2ifisnull.py        用“IF(ISNULL(A), B, A)”替换像“IFNULL(A, B)”的实例</p>
</li>
<li>
<p>lowercase.py        用小写值替换每个关键字字符</p>
</li>
<li>
<p>modsecurityversioned.py        用注释包围完整的查询</p>
</li>
<li>
<p>modsecurityzeroversioned.py        用当中带有数字零的注释包围完整的查询</p>
</li>
<li>
<p>multiplespaces.py        在SQL关键字周围添加多个空格</p>
</li>
<li>
<p>nonrecursivereplacement.py        用representations替换预定义SQL关键字，适用于过滤器</p>
</li>
<li>
<p>overlongutf8.py        转换给定的payload当中的所有字符</p>
</li>
<li>
<p>percentage.py        在每个字符之前添加一个百分号</p>
</li>
<li>
<p>randomcase.py        随机转换每个关键字字符的大小写</p>
</li>
<li>
<p>randomcomments.py        向SQL关键字中插入随机注释</p>
</li>
<li>
<p>securesphere.py        添加经过特殊构造的字符串</p>
</li>
<li>
<p>sp_password.py        向payload末尾添加“sp_password” for automatic obfuscation from DBMS logs</p>
</li>
<li>
<p>space2comment.py        用“/**/”替换空格符</p>
</li>
<li>
<p>space2dash.py        用破折号注释符“--”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2hash.py        用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2morehash.py        用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</p>
</li>
<li>
<p>space2mssqlblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>space2mssqlhash.py        用磅注释符“#”其次是一个换行符替换空格符</p>
</li>
<li>
<p>space2mysqlblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>space2mysqldash.py        用破折号注释符“--”其次是一个换行符替换空格符</p>
</li>
<li>
<p>space2plus.py        用加号“+”替换空格符</p>
</li>
<li>
<p>space2randomblank.py        用一组有效的备选字符集当中的随机空白符替换空格符</p>
</li>
<li>
<p>unionalltounion.py        用“UNION SELECT”替换“UNION ALL SELECT”</p>
</li>
<li>
<p>unmagicquotes.py        用一个多字节组合%bf%27和末尾通用注释一起替换空格符</p>
</li>
<li>
<p>varnish.py        添加一个HTTP头“X-originating-IP”来绕过WAF</p>
</li>
<li>
<p>versionedkeywords.py        用MySQL注释包围每个非函数关键字</p>
</li>
<li>
<p>versionedmorekeywords.py        用MySQL注释包围每个关键字</p>
</li>
<li>
<p>xforwardedfor.py        添加一个伪造的HTTP头“X-Forwarded-For”来绕过WAF</p>
</li>
</ol>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>