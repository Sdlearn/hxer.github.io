<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <title>w3af - Wiki | janes</title>
        <meta name="keywords" content=""/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/#Kali2">Kali2</a>&nbsp;»&nbsp;w3af</div>
</div>
<div class="clearfix"></div>
<div id="title">w3af</div>
  <div id="content">
  <h2 id="0x00">0x00 简介</h2>
<p><a href="http://docs.w3af.org/en/latest/">w3af document</a></p>
<p><a href="http://w3af.org/plugins">w3af plugins</a></p>
<h2 id="0x01-plugins">0x01 plugins</h2>
<div class="hlcode"><pre><span class="cp"># 查看 sqli 的详细信息</span>
<span class="n">w3af</span><span class="o">/</span><span class="n">plugins</span><span class="o">&gt;&gt;&gt;</span><span class="n">audit</span> <span class="n">desc</span> <span class="n">sqli</span>

<span class="cp"># 查看配置</span>
<span class="n">w3af</span><span class="o">/</span><span class="n">plugins</span><span class="o">&gt;&gt;&gt;</span><span class="n">audit</span> <span class="n">config</span> <span class="n">xss</span>
<span class="n">w3af</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">config</span><span class="o">:</span><span class="n">xss</span><span class="o">&gt;&gt;&gt;</span><span class="n">view</span> 
</pre></div>


<h3 id="plugin-type">plugin type</h3>
<p>main plugins type: <code>crawl</code>(漏洞挖掘), <code>audit</code>(漏洞分析) and <code>attack</code>(漏洞攻击)</p>
<h3 id="output">output</h3>
<h2 id="0x02-http-settings">0x02 http-settings</h2>
<ul>
<li>headers_file</li>
</ul>
<p>w3af 从文件中解析 header, 不过会修改 User-agent 为 w3af 设置的值, 如下所示</p>
<div class="hlcode"><pre><span class="n">path</span><span class="o">:</span> <span class="n">w3af</span><span class="sr">/core/data/url/</span><span class="n">opener_settings</span><span class="o">.</span><span class="na">py</span>

<span class="n">def</span> <span class="n">set_headers_file</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">headers_file</span><span class="o">):</span>
    <span class="o">...</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="o">(</span><span class="n">headers_file</span><span class="o">,</span> <span class="s1">&#39;r&#39;</span><span class="o">)</span>      <span class="err">#</span> <span class="n">support</span> <span class="n">ralative</span> <span class="n">path</span> <span class="n">and</span> <span class="n">absolute</span> <span class="n">path</span> <span class="o">================</span>
    <span class="o">...</span>
    <span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">f</span><span class="o">:</span>
        <span class="n">header_name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s1">&#39;:&#39;</span><span class="o">)[</span><span class="mi">0</span><span class="o">]</span>
        <span class="n">header_value</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">line</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s1">&#39;:&#39;</span><span class="o">)[</span><span class="mi">1</span><span class="o">:])</span>    <span class="err">#</span> <span class="n">line</span> <span class="n">without</span> <span class="s2">&quot;:&quot;</span> <span class="n">will</span> <span class="n">raise</span> <span class="n">error</span> <span class="o">===</span>
        <span class="n">header_value</span> <span class="o">=</span> <span class="n">header_value</span><span class="o">.</span><span class="na">strip</span><span class="o">()</span>
        <span class="n">header_list</span><span class="o">.</span><span class="na">append</span><span class="o">((</span><span class="n">header_name</span><span class="o">,</span> <span class="n">header_value</span><span class="o">))</span>
    <span class="o">...</span>

<span class="n">def</span> <span class="n">set_user_agent</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">user_agent</span><span class="o">):</span>
        <span class="n">self</span><span class="o">.</span><span class="na">header_list</span> <span class="o">=</span> <span class="o">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">self</span><span class="o">.</span><span class="na">header_list</span> <span class="k">if</span> <span class="n">i</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">lower</span><span class="o">()</span>
                            <span class="o">!=</span> <span class="n">USER_AGENT_HEADER</span><span class="o">]</span>
        <span class="n">self</span><span class="o">.</span><span class="na">header_list</span><span class="o">.</span><span class="na">append</span><span class="o">((</span><span class="n">USER_AGENT_HEADER</span><span class="o">,</span> <span class="n">user_agent</span><span class="o">))</span>
        <span class="n">cfg</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="s1">&#39;user_agent&#39;</span><span class="o">,</span> <span class="n">user_agent</span><span class="o">)</span>
</pre></div>


<p>从源码分析可知， headers_file 文件中设置的 user-agent 并不会生效，<code>set user_agent x</code> 才是有效的; 读 headers_file 文件支持相对路径和绝对路径; 文件中每行必须用 <code>":"</code> 分隔 <code>key: value</code>, 并且文件中不能出现空行， 否则导致解析出错， console 报错如下：</p>
<div class="hlcode"><pre><span class="n">The</span> <span class="n">following</span> <span class="n">error</span> <span class="n">was</span> <span class="n">detected</span> <span class="n">and</span> <span class="n">could</span> <span class="n">not</span> <span class="n">be</span> <span class="n">resolved</span><span class="o">:</span>
<span class="n">The</span> <span class="n">remote</span> <span class="n">web</span> <span class="n">server</span> <span class="n">is</span> <span class="n">not</span> <span class="n">answering</span> <span class="n">our</span> <span class="n">HTTP</span> <span class="n">requests</span><span class="p">,</span> <span class="n">multiple</span> <span class="n">errors</span> <span class="n">have</span> <span class="n">been</span> <span class="n">found</span> <span class="k">while</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">GET</span> <span class="n">a</span> <span class="n">response</span> <span class="n">from</span> <span class="n">the</span> <span class="n">server</span><span class="p">.</span>
</pre></div>


<h3 id="proxy_address">proxy_address</h3>
<p>通过 <code>set proxy_address 127.0.0.1</code>, 可以使用 burpsuite 等代理软件监听 w3af 请求 </p>
<h2 id="0x03-profiles">0x03 profiles</h2>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2016 .
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>